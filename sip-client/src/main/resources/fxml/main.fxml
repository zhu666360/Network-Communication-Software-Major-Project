<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.example.sipclient.gui.controller.MainController"
            prefWidth="900" prefHeight="600"
            stylesheets="@../css/style.css"
            styleClass="root">

    <!-- å·¦ä¾§è”ç³»äººåˆ—è¡¨ -->
    <left>
        <VBox styleClass="sidebar" prefWidth="280">
            <!-- æ ‡é¢˜æ å’Œå·¥å…·æ  -->
            <VBox style="-fx-background-color: white; -fx-padding: 15;" spacing="10">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="è”ç³»äºº" styleClass="header-label"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="âž•" onAction="#handleAddContact" 
                           styleClass="button, success-button, icon-button"/>
                    <Button text="âš™" onAction="#handleOpenSettings"
                           styleClass="button, icon-button"/>
                    <Button text="ðŸšª" onAction="#handleLogout"
                           styleClass="button, danger-button, icon-button">
                        <tooltip>
                            <Tooltip text="æ³¨é”€"/>
                        </tooltip>
                    </Button>
                </HBox>
                <!-- æœç´¢æ¡† -->
                <TextField fx:id="searchField" promptText="æœç´¢è”ç³»äººæˆ–æ¶ˆæ¯..."
                          style="-fx-background-radius: 15;"/>
            </VBox>
            <Separator/>
            <ListView fx:id="contactListView" VBox.vgrow="ALWAYS"
                     styleClass="list-view"/>
        </VBox>
    </left>

    <!-- ä¸­é—´èŠå¤©åŒºåŸŸ -->
    <center>
        <VBox styleClass="chat-area">
            <!-- èŠå¤©æ ‡é¢˜æ  -->
            <HBox alignment="CENTER_LEFT" spacing="10" style="-fx-background-color: white; -fx-padding: 15; -fx-border-color: #dee2e6; -fx-border-width: 0 0 1 0;">
                <Label fx:id="chatTitleLabel" text="é€‰æ‹©è”ç³»äººå¼€å§‹èŠå¤©"
                       styleClass="header-label"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="ðŸ”" onAction="#handleSearchMessage" 
                       styleClass="button, warning-button"/>
                <Button fx:id="callButton" text="ðŸ“ž è¯­éŸ³é€šè¯" onAction="#handleMakeCall"
                       styleClass="button, success-button"/>
                <Button fx:id="videoCallButton" text="ðŸŽ¥ è§†é¢‘é€šè¯" onAction="#handleMakeVideoCall"
                       styleClass="button, info-button"
                       style="-fx-background-color: #17a2b8;"/>
            </HBox>

            <!-- èŠå¤©æ¶ˆæ¯åŒºåŸŸ -->
            <ScrollPane fx:id="chatScrollPane" VBox.vgrow="ALWAYS"
                       fitToWidth="true" styleClass="scroll-pane">
                <VBox fx:id="chatBox" spacing="15" style="-fx-padding: 20; -fx-background-color: white;"/>
            </ScrollPane>

            <!-- è¾“å…¥åŒºåŸŸ -->
            <VBox style="-fx-background-color: #f8f9fa; -fx-padding: 15; -fx-border-color: #dee2e6; -fx-border-width: 1 0 0 0;" spacing="10">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Button text="ðŸ˜€" onAction="#handleShowEmoji"
                           styleClass="icon-button" style="-fx-font-size: 20px;"/>
                    <Button text="ðŸ“Ž" onAction="#handleAttachFile"
                           styleClass="icon-button" style="-fx-font-size: 18px;"/>
                </HBox>
                <TextArea fx:id="messageInput" promptText="è¾“å…¥æ¶ˆæ¯... (Shift+Enter æ¢è¡Œ, Enter å‘é€)"
                         wrapText="true" prefRowCount="3"
                         styleClass="text-area"/>
                <HBox alignment="CENTER_RIGHT">
                    <Button fx:id="sendButton" text="å‘é€" onAction="#handleSendMessage"
                           prefWidth="100" prefHeight="35"
                           styleClass="button"/>
                </HBox>
            </VBox>
        </VBox>
    </center>

    <!-- åº•éƒ¨çŠ¶æ€æ  -->
    <bottom>
        <HBox style="-fx-background-color: #e9ecef; -fx-padding: 5 15;">
            <Label fx:id="statusLabel" text="å°±ç»ª" styleClass="subtitle-label" style="-fx-font-size: 12px;"/>
        </HBox>
    </bottom>
</BorderPane>
